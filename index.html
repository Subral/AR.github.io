<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
      AFRAME.registerComponent('tap-to-place', {
        init: function () {
          const sceneEl = this.el.sceneEl;
          sceneEl.addEventListener('click', (event) => {
            const touchPoint = event.detail.intersection.point;
            this.placeBox(touchPoint);
          });
        },
        
        placeBox: function (position) {
          const box = document.createElement('a-box');
          box.setAttribute('position', position);
          box.setAttribute('color', 'red');
          
          // Calculate size based on distance
          const camera = document.querySelector('a-camera');
          const distance = this.getDistance(camera.object3D.position, position);
          const size = this.calculateSize(distance);
          
          box.setAttribute('width', size);
          box.setAttribute('height', size);
          box.setAttribute('depth', size);
          
          this.el.sceneEl.appendChild(box);
        },
        
        getDistance: function (p1, p2) {
          const dx = p1.x - p2.x;
          const dy = p1.y - p2.y;
          const dz = p1.z - p2.z;
          return Math.sqrt(dx * dx + dy * dy + dz * dz);
        },
        
        calculateSize: function (distance) {
          // Adjust this formula as needed
          return Math.max(0.1, Math.min(1, distance * 0.1));
        }
      });
    </script>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
      <a-camera tap-to-place ></a-camera>
      <a-entity id="ar-model" gps-entity-place gltf-model="magnemite/scene.gltf" rotation="0 180 0" animation-mixer scale="0.15 0.15 0.15"></a-entity>
    </a-scene>
  </body>
</html>